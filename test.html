<!DOCTYPE html>
<html>

<head>
    <title>Three.js TypeScript Tutorials by Sean Bradley : https://sbcode.net/threejs</title>
    <style>
    * {
      margin: 0;
      padding: 0;
    }

    canvas {
      display: block;
      height: 100%;
      width: 100%;
    }
    </style>
</head>

<body>
    <script type="module">
        import * as THREE from './res/three.module.js';
        import { TrackballControls } from './res/TrackballControls.js';
        const scene = new THREE.Scene();
        const axesHelper = new THREE.AxesHelper(5);
        scene.add(axesHelper);
        var light = new THREE.HemisphereLight();
        scene.add(light);
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer();
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);
        //const controls = new TrackballControls(camera, renderer.domElement);
        const geometry = new THREE.BoxGeometry();
        const material = new THREE.MeshBasicMaterial({ color: 0x00ff00, wireframe: true });
        const cube = new THREE.Mesh(geometry, material);
        var lastx=0;
        var lasty=0;
        var dx=0;
        var dy=0;
        var degy = 0;
        var istracking=false;
        renderer.domElement.onmousedown = function(event){
            istracking = true;
            console.log("down");
        };
        renderer.domElement.onmousemove=function(event){
            if(!istracking){
                return;
            }
            dx = event.clientX-lastx;
            dy = event.clientY-lasty;
            lastx = event.clientX;
            lasty = event.clientY;
            if(dx>100 || dy>100){
                return;
            }
            degy = degy +0.01*dx;
            cube.rotateOnWorldAxis(new THREE.Vector3(0,1, 0), THREE.Math.degToRad(1)*dx);
            cube.rotateOnWorldAxis(new THREE.Vector3(1,0, 0), THREE.Math.degToRad(1)*dy);
            console.log(degy);
        };
        renderer.domElement.onmouseup = function(event){
            istracking = false;
            console.log("up");
        };        
        scene.add(cube);
        camera.position.z = 2;
        window.addEventListener('resize', onWindowResize, false);
        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
            render();
        }
    
        var animate = function () {
            requestAnimationFrame(animate);
            //controls.update();
            render();
        
        };
        function render() {
            renderer.render(scene, camera);
        }
        animate();


    </script>
</body>

</html>